<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <!-- titre de la page affiché à l'utilisateur-->
        <title>Cheat Sheet Creator Panel</title>
        <!-- mise en forme de la page afin d'avoir de grand espace d'entrée pour que l'utilisateur voit ce qu'il écrit-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <script defer>
            function getCookie(cookieName) {
                let cookies = document.cookie;
                console.log("cookies", cookies)
                for (let currentCookie of cookies.split("; ")) {
                    console.log("currentCookie", currentCookie)
                    let currentCookieSplit = currentCookie.split("=");
                    let currentCookieName = currentCookieSplit[0];
                    let currentCookieBody = currentCookieSplit[1];
                    console.log(cookieName, currentCookieName)
                    if (currentCookieName === cookieName) {
                        return currentCookieBody;
                    }
                }
                return "";
            }


            function uploadNewCheatSheet() {
                let authorToken = getCookie("account-token");
                let titleInput = document.querySelector("#title-input");
                let contentInput = document.querySelector("#content-input");
                let contextInput = document.querySelector("#context-input");
                console.log(authorToken);
                
                fetch("http://127.0.0.1:5000/create-cheat-sheet", {
                    method: "POST",
                    body: JSON.stringify({
                        title: titleInput.value,
                        content: contentInput.value,
                        context: contextInput.value,
                        author_token: authorToken,
                    }),
                    headers: {
                        "Content-type": "application/json; charset=UTF-8",
                    }
                });
            }

        </script>
    </head>
    <!-- contenu de la page en elle-même-->
    <body>
        <!-- ouverture formulaire à remplir par le créateur de la fiche, permet de le récupérer rapidement-->
        <div class="container">
            <form>

                <!-- nom de la fiche de révision-->
                <div class="form-group">
                    <label for="title-input">Cheat sheet's title</label>
                    <input class="form-control" type="text" id="title-input" name="title" autocomplete="off">
                </div>

                <!-- contenu de la fiche de révision, rédigée impérativement en markdown-->
                <div class="form-group">
                    <label for="content-input">Content of the new cheat sheet <strong>written in markdown</strong></label>
                    <textarea class="form-control" id="content-input" name="content" autocomplete="off"></textarea>
                </div>

                <!-- commentaire du créateur de la fiche à propos de sa fiche-->
                <div class="form-group">
                    <label for="comment-input">Cheat sheet's content</label>
                    <textarea class="form-control" id="context-input" name="context" autocomplete="off"></textarea>
                </div>
                
                <!-- bouton permettant à l'utilisateur de sauvegarder son travail et donc mettre sa fiche en ligne-->
                <button class="btn btn-primary" type="button" onclick="uploadNewCheatSheet();">Upload cheat sheet</button>
            </form>
        </div>


        
    </body>
</html>